Very similar to KeyValuePairOfListsOfKeyValuePairsEnumerator. however, 
nested lists have to be handled differently.